import logging

import nmap
from core.Scanning.Network.deviceDiscov import deviceDiscover
from core.Scanning.Network.serviceDiscov import serviceDiscover


class NetExplorer:

    def __init__(self, subnet):
        self.covert_lvl = 3
        self.dd = deviceDiscover(subnet, lvl=self.covert_lvl)
        self.sd = serviceDiscover(lvl=self.covert_lvl)
        self.devices = []

    def deviceDiscover(self):
        res = self.dd.scan()
        for d in res:
            self.devices.append(d)

    def subnetDiscov(self):
        if not self.devices:
            for d in self.devices:
                self.sd.scan(d)
        else:
            logging.error("No Devices Discovered. Enter manual mode or use device discovery")

    def serviceDiscov(self):
        print()

    def vulnDiscov(self):
        print()

    def covert_change(self, lvl):
        lvl = int(lvl)
        if 1 > lvl > 4:
            logging.error("Covert level out of bounds. Bounds 0-4")
            return False
        self.covert_lvl = lvl
        self.sd.change_lvl(self.covert_lvl)
        self.dd.change_lvl(self.covert_lvl)
        return True
