import re
import pandas
from tabulate import tabulate

from core.Scanning.Core.Database import Database


def not_match(l, i):
    if not l:
        return False
    elif l[-1]["id"] == i:
        return False
    else:
        return True


class Service:

    def __init__(self, port, version, name, product, extra, cpe, state):
        self.version = version
        self.port = port
        self.name = name
        self.product = product
        self.extra = extra
        self.cpe = cpe
        self.state = state
        self.vuln = 'Unknown'

    def text(self):
        res = (self.name
               + '\nVersion: ' + self.version
               + '\nPort: ' + str(self.port)
               + '\nProduct: ' + self.product
               + '\nExtra details: ' + self.extra
               + '\nCPE(Customer Premise Equipment): ' + self.cpe
               + '\nState(As of last scan): ' + self.state
               + '\nPotentially Vulnerable: ' + self.vuln + '\n')
        return res


