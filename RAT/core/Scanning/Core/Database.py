from bs4 import BeautifulSoup


class Database_record:
    def __init__(self, name, data, extra=""):
        self.id = name
        self.data = data
        self.extra = extra

    def get_data(self):
        return [self.id, self.data, self.extra]


class Database:

    def __init__(self, name, form):
        self.name = name
        self.format = form
        self.records = []

    def populate_db_raw_data(self, records):
        r = records.dropna(thresh=2)
        col = list(r.columns)
        if self.format == 2:
            for index, row in r.iterrows():
                clean_d = BeautifulSoup(row[col[1]], "lxml").text
                new_record = Database_record(row[col[0]], clean_d)
                self.records.append(new_record)
        elif self.format >= 3:
            for index, row in r.iterrows():
                clean_d = BeautifulSoup(row[col[1]], "lxml").text
                clean_e = BeautifulSoup(row[col[2]], "lxml").text
                new_record = Database_record(row[col[0]], clean_d, clean_e)
                self.records.append(new_record)
        else:
            print("Improper database detected. Database import aborted.")
            return False
        return True

    def add_record(self, record):
        self.records.append(record)

    def change_name(self, name):
        self.name = name
