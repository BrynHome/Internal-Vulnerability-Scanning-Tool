import core.Scanning.Network.deviceDiscov as dd
import core.Scanning.Network.serviceDiscov as ss
import core.Scanning.Core.Device as d
import core.Scanning.Core.Subnet as sub
import unittest


def service_discov_test():
    device = d.Device('192.168.1.64', '70:8B:CD:50:46:AA')
    serviceS = ss.serviceDiscover(2, '100-180', '440-450')
    print(serviceS.scan(device))
    print(device.general_text())
    print(device.service_text())
    print("done")

def no_services_found_test():
    device = d.Device('192.168.1.64', '70:8B:CD:50:46:AA')
    serviceS = ss.serviceDiscover(2, '30005-30011', '30005-30011')
    serviceS.scan(device)
    print(device.general_text())
    print(device.service_text())
    print("done")


def device_discov_test():
    sb = sub.subnet()
    deviceD = dd.deviceDiscover("192.168.1.0/24")
    deviceD.scan()


def device_service_test():
    a = dd.deviceDiscover("192.168.1.0/24", 3)
    devices = a.scan()
    print(devices[0].ip)
    b = ss.serviceDiscover(2, '1-100', '1-100')
    b.scan(devices[0])
    print(b.scanner.csv())


def improper_device():
    device = d.Device('garble', '70:8B:CD:50:46:AA')
    serviceS = ss.serviceDiscover(2, '30005-30011', '30005-30011')
    print(serviceS.scan(device))
    print(device.general_text())
    print(device.service_text())
    print("done")

def improper_ports():
    device = d.Device('192.168.1.84', '70:8B:CD:50:46:AA')
    serviceS = ss.serviceDiscover(2, '100-180', '440-450')
    print(serviceS.tcp_scan("hi,1,g,45",device))
    print(device.general_text())
    print(device.service_text())
    print("done")

#device_discov_test()
#no_services_found_test()
service_discov_test()
improper_device()
improper_ports()


