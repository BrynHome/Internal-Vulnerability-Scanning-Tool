import logging
from core import driver
import socket
import signal
import sys


def signal_handler(sig, frame):
    print('\n\033[1;31mExiting...')
    sys.exit(0)


if __name__ == "__main__":
    signal.signal(signal.SIGINT, signal_handler)
    while True:
        hostname = socket.gethostname()
        local_ip = socket.gethostbyname(hostname)
        subnet = local_ip.rsplit('.', 1)[0] + '.0/24'
        print("\033[1;31mLocal Address: " + local_ip)
        print(subnet + " subnet set as default for network discover")
        # print("\n\033[1;32mChoose Starting Mode:\n\033[1;37m1: Direct\n2: Remote\n")
        # mode = input()
        code = driver.start("1", subnet)
        if code == 1:
            exit(1)
        elif code == 0:
            logging.error("Improper Input.\nEnter 1 to control directly.\nEnter 2 to setup for remote control\n")
        else:
            logging.error(code)
            exit(-1)
